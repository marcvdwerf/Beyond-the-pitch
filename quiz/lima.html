import React, { useState } from 'react';
import { Trophy, Star, Heart, Flame, ArrowRight, CheckCircle2, XCircle, Globe, BookOpen } from 'lucide-react';

const QuizApp = () => {
  const [currentStep, setCurrentStep] = useState('intro');
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [answers, setAnswers] = useState({});
  const [score, setScore] = useState(0);
  const [showFeedback, setShowFeedback] = useState(false);
  const [selectedAnswer, setSelectedAnswer] = useState(null);
  const [language, setLanguage] = useState('es'); // 'es' or 'en'

  const translations = {
    es: {
      title: 'ALIANZA LIMA',
      subtitle: 'Trivia Challenge',
      tagline: 'Â¿QuÃ© tanto sabes sobre los Ãntimos?',
      questions: 'Preguntas',
      points: 'Puntos',
      perAnswer: 'Por respuesta',
      duration: 'DuraciÃ³n',
      startQuiz: 'Â¡Empezar el Quiz!',
      question: 'Pregunta',
      of: 'de',
      yourScore: 'Tu puntuaciÃ³n final:',
      step: 'Paso',
      next: 'Siguiente',
      finish: 'Finalizar',
      thanks: 'Â¡Gracias',
      contactSoon: 'Te contactaremos pronto con experiencias exclusivas de Alianza Lima.',
      readMore: 'Leer mÃ¡s',
      continue: 'Continuar',
      correct: 'Â¡Correcto!',
      interesting: 'Â¡Interesante!',
      scoreMessages: {
        perfect: 'Â¡Perfecto! Eres un verdadero Ãntimo ðŸ’™',
        great: 'Â¡Excelente! Conoces bien al club ðŸ‘',
        good: 'Â¡Bien! Pero puedes aprender mÃ¡s ðŸ“–',
        learn: 'Â¡Sigue aprendiendo sobre los Blanquiazules! ðŸ’ª'
      }
    },
    en: {
      title: 'ALIANZA LIMA',
      subtitle: 'Trivia Challenge',
      tagline: 'How much do you know about Los Ãntimos?',
      questions: 'Questions',
      points: 'Points',
      perAnswer: 'Per answer',
      duration: 'Duration',
      startQuiz: 'Start Quiz!',
      question: 'Question',
      of: 'of',
      yourScore: 'Your final score:',
      step: 'Step',
      next: 'Next',
      finish: 'Finish',
      thanks: 'Thank you',
      contactSoon: 'We will contact you soon with exclusive Alianza Lima experiences.',
      readMore: 'Read more',
      continue: 'Continue',
      correct: 'Correct!',
      interesting: 'Interesting!',
      scoreMessages: {
        perfect: 'Perfect! You are a true Ãntimo ðŸ’™',
        great: 'Excellent! You know the club well ðŸ‘',
        good: 'Good! But you can learn more ðŸ“–',
        learn: 'Keep learning about Los Blanquiazules! ðŸ’ª'
      }
    }
  };

  const t = translations[language];

  const triviaQuestions = [
    {
      question: { es: 'Â¿En quÃ© aÃ±o fue fundado Alianza Lima?', en: 'In what year was Alianza Lima founded?' },
      options: ['1901', '1905', '1910', '1915'],
      correct: '1901',
      image: 'https://googleusercontent.com/image_generation_content/1',
      shortFact: { es: 'Â¡Correcto! El 15 de febrero de 1901.', en: 'Correct! On February 15, 1901.' },
      longFact: {
        es: 'Alianza Lima fue fundado el 15 de febrero de 1901 en el barrio de La Victoria, Lima. Originalmente se llamaba "Sport Alianza".',
        en: 'Alianza Lima was founded on February 15, 1901 in the La Victoria neighborhood, Lima. Originally called "Sport Alianza".'
      }
    },
    {
      question: { es: 'Â¿CuÃ¡l es el apodo mÃ¡s popular del club?', en: 'What is the most popular nickname of the club?' },
      options: [
        { es: 'Los Blanquiazules', en: 'Los Blanquiazules' },
        { es: 'Los Ãntimos', en: 'Los Ãntimos' },
        { es: 'Los Aliancistas', en: 'Los Aliancistas' },
        { es: 'Todos los anteriores', en: 'All of the above' }
      ],
      correct: language === 'es' ? 'Todos los anteriores' : 'All of the above',
      image: 'https://googleusercontent.com/image_generation_content/2',
      shortFact: { es: 'Â¡Exacto! El club tiene varios apodos.', en: 'Exactly! The club has several nicknames.' },
      longFact: {
        es: 'Alianza Lima es conocido como "Los Blanquiazules", "Los Ãntimos" y "Los Aliancistas". Cada nombre tiene su historia.',
        en: 'Alianza Lima is known as "Los Blanquiazules", "Los Ãntimos", and "Los Aliancistas". Each name has its history.'
      }
    },
    {
      question: { es: 'Â¿CuÃ¡ntos tÃ­tulos nacionales ha ganado Alianza Lima?', en: 'How many national titles has Alianza Lima won?' },
      options: ['20', '23', '25', '28'],
      correct: '25',
      image: 'https://googleusercontent.com/image_generation_content/3',
      shortFact: { es: 'Â¡Correcto! 25 tÃ­tulos nacionales.', en: 'Correct! 25 national titles.' },
      longFact: {
        es: 'Alianza Lima ha conquistado 25 tÃ­tulos de la Liga Peruana, siendo uno de los clubes mÃ¡s exitosos del paÃ­s.',
        en: 'Alianza Lima has won 25 Peruvian League titles, being one of the most successful clubs in the country.'
      }
    },
    {
      question: { es: 'Â¿CÃ³mo se llama el estadio de Alianza Lima?', en: 'What is the name of Alianza Lima\'s stadium?' },
      options: [
        { es: 'Estadio Nacional', en: 'Estadio Nacional' },
        { es: 'Estadio Monumental', en: 'Estadio Monumental' },
        { es: 'Estadio Alejandro Villanueva', en: 'Estadio Alejandro Villanueva' },
        { es: 'Estadio San Marcos', en: 'Estadio San Marcos' }
      ],
      correct: 'Estadio Alejandro Villanueva',
      image: 'https://googleusercontent.com/image_generation_content/4',
      shortFact: { es: 'Â¡Perfecto! TambiÃ©n conocido como "Matute".', en: 'Perfect! Also known as "Matute".' },
      longFact: {
        es: 'El Estadio Alejandro Villanueva, conocido como "Matute", es la casa de Alianza Lima desde 1974.',
        en: 'The Alejandro Villanueva Stadium, known as "Matute", has been Alianza Lima\'s home since 1974.'
      }
    },
    {
      question: { es: 'Â¿QuiÃ©n es considerado el mÃ¡ximo Ã­dolo de Alianza Lima?', en: 'Who is considered the greatest idol of Alianza Lima?' },
      options: ['TeÃ³filo Cubillas', 'Jefferson FarfÃ¡n', 'Waldir SÃ¡enz', 'Paolo Guerrero'],
      correct: 'TeÃ³filo Cubillas',
      image: 'https://googleusercontent.com/image_generation_content/5',
      shortFact: { es: 'Â¡Correcto! "Nene" Cubillas es una leyenda.', en: 'Correct! "Nene" Cubillas is a legend.' },
      longFact: {
        es: 'TeÃ³filo Cubillas, "El Nene", es considerado el mÃ¡ximo Ã­dolo y uno de los mejores futbolistas peruanos.',
        en: 'TeÃ³filo Cubillas, "El Nene", is considered the greatest idol and one of the best Peruvian footballers.'
      }
    },
    {
      question: { es: 'Â¿CuÃ¡l es el clÃ¡sico rival de Alianza Lima?', en: 'Who is the classic rival of Alianza Lima?' },
      options: ['Sporting Cristal', 'Universitario', 'Melgar', 'Cienciano'],
      correct: 'Universitario',
      image: 'https://googleusercontent.com/image_generation_content/6',
      shortFact: { es: 'Â¡Exacto! El clÃ¡sico del fÃºtbol peruano.', en: 'Exactly! The classic of Peruvian football.' },
      longFact: {
        es: 'El ClÃ¡sico entre Alianza Lima y Universitario es la rivalidad mÃ¡s grande y apasionante del PerÃº.',
        en: 'The Classic between Alianza Lima and Universitario is the biggest and most passionate rivalry in Peru.'
      }
    }
  ];

  const contactQuestions = [
    { id: 'name', type: 'text', question: { es: 'Â¿CuÃ¡l es tu nombre?', en: 'What is your name?' }, placeholder: { es: 'Tu nombre...', en: 'Your name...' } },
    { id: 'email', type: 'email', question: { es: 'Â¿CuÃ¡l es tu correo electrÃ³nico?', en: 'What is your email?' }, placeholder: { es: 'tu@email.com', en: 'your@email.com' } },
    { id: 'location', type: 'choice', question: { es: 'Â¿DÃ³nde vives?', en: 'Where do you live?' }, options: { es: ['Lima', 'Otra ciudad de PerÃº', 'PaÃ­ses Bajos', 'Otro paÃ­s'], en: ['Lima', 'Other city in Peru', 'Netherlands', 'Other country'] } },
    { id: 'interest', type: 'choice', question: { es: 'Â¿QuÃ© te gustarÃ­a recibir?', en: 'What would you like to receive?' }, options: { es: ['Experiencias VIP', 'Noticias exclusivas', 'Ofertas especiales', 'Todo lo anterior'], en: ['VIP Experiences', 'Exclusive news', 'Special offers', 'All of the above'] } }
  ];

  const handleTriviaAnswer = (answer) => {
    setSelectedAnswer(answer);
    setShowFeedback('short');
    if (answer === triviaQuestions[currentQuestion].correct) setScore(score + 1);
  };

  const handleContinue = () => {
    if (currentQuestion < triviaQuestions.length - 1) {
      setCurrentQuestion(currentQuestion + 1);
      setShowFeedback(false);
      setSelectedAnswer(null);
    } else {
      setCurrentStep('contact');
      setCurrentQuestion(0);
    }
  };

  if (currentStep === 'intro') {
    return (
      <div className="min-h-screen bg-slate-900 flex items-center justify-center p-4">
        <div className="bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full text-center relative overflow-hidden">
          <img src="https://googleusercontent.com/image_generation_content/0" alt="Intro" className="absolute inset-0 w-full h-full object-cover opacity-10 z-0" />
          <div className="relative z-10">
            <div className="absolute top-0 right-0 flex gap-2">
              <button onClick={() => setLanguage('es')} className={`px-3 py-1 rounded-lg text-xs font-bold ${language === 'es' ? 'bg-blue-600 text-white' : 'bg-gray-100'}`}>ES</button>
              <button onClick={() => setLanguage('en')} className={`px-3 py-1 rounded-lg text-xs font-bold ${language === 'en' ? 'bg-blue-600 text-white' : 'bg-gray-100'}`}>EN</button>
            </div>
            <div className="mb-8">
              <h1 className="text-4xl font-bold text-blue-900 mb-2">{t.title}</h1>
              <p className="text-xl text-blue-600 font-semibold mb-2">{t.subtitle}</p>
              <p className="text-gray-600 italic">{t.tagline}</p>
            </div>
            <div className="grid grid-cols-3 gap-4 mb-8 bg-blue-50 p-6 rounded-2xl">
              <div><Trophy className="mx-auto text-blue-600 mb-1" /> <p className="font-bold">{triviaQuestions.length}</p><p className="text-xs">{t.questions}</p></div>
              <div><Star className="mx-auto text-yellow-500 mb-1" /> <p className="font-bold">100</p><p className="text-xs">{t.perAnswer}</p></div>
              <div><Flame className="mx-auto text-orange-500 mb-1" /> <p className="font-bold">3 min</p><p className="text-xs">{t.duration}</p></div>
            </div>
            <button onClick={() => setCurrentStep('trivia')} className="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-2 hover:bg-blue-700 transition-all">
              {t.startQuiz} <ArrowRight />
            </button>
          </div>
        </div>
      </div>
    );
  }

  if (currentStep === 'trivia') {
    const q = triviaQuestions[currentQuestion];
    const progress = ((currentQuestion + 1) / triviaQuestions.length) * 100;

    return (
      <div className="min-h-screen bg-slate-900 flex items-center justify-center p-4">
        <div className="max-w-xl w-full">
          <div className="mb-4 h-2 bg-white/20 rounded-full overflow-hidden">
            <div className="h-full bg-blue-500 transition-all duration-500" style={{ width: `${progress}%` }} />
          </div>
          <div className="bg-white rounded-3xl shadow-2xl overflow-hidden">
            <div className="h-56 relative">
              <img src={q.image} alt="Question" className="w-full h-full object-cover" />
              <div className="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex items-end p-6">
                <h2 className="text-white text-xl font-bold leading-tight">{q.question[language]}</h2>
              </div>
            </div>
            <div className="p-6 space-y-3">
              {q.options.map((opt, i) => {
                const text = typeof opt === 'object' ? opt[language] : opt;
                const isSelected = selectedAnswer === text;
                const isCorrect = text === q.correct;
                let style = "border-gray-200 text-gray-700 hover:bg-blue-50";
                if (showFeedback) {
                   if (isCorrect) style = "bg-green-100 border-green-500 text-green-800 font-bold";
                   else if (isSelected) style = "bg-red-100 border-red-500 text-red-800";
                   else style = "opacity-50 border-gray-100";
                }
                return (
                  <button key={i} disabled={showFeedback} onClick={() => handleTriviaAnswer(text)} className={`w-full p-4 text-left border-2 rounded-xl transition-all flex justify-between items-center ${style}`}>
                    {text}
                    {showFeedback && isCorrect && <CheckCircle2 className="w-5 h-5" />}
                    {showFeedback && isSelected && !isCorrect && <XCircle className="w-5 h-5" />}
                  </button>
                );
              })}
              {showFeedback && (
                <div className="mt-4 p-4 bg-blue-50 rounded-xl animate-in fade-in slide-in-from-bottom-2">
                  <p className="text-sm text-blue-800 mb-3">{q.shortFact[language]}</p>
                  <button onClick={handleContinue} className="w-full bg-blue-600 text-white py-3 rounded-xl font-bold flex items-center justify-center gap-2">
                    {t.continue} <ArrowRight className="w-4 h-4" />
                  </button>
                </div>
              )}
            </div>
          </div>
        </div>
      </div>
    );
  }

  if (currentStep === 'contact' || currentStep === 'complete') {
    // Hier zou de rest van de stappen (contact en complete) komen zoals in je originele code, 
    // maar dan passend in de nieuwe visuele stijl.
    return (
      <div className="min-h-screen bg-slate-900 flex items-center justify-center p-4">
        <div className="bg-white rounded-3xl p-8 max-w-md w-full text-center">
            <Trophy className="mx-auto w-16 h-16 text-yellow-500 mb-4" />
            <h2 className="text-2xl font-bold mb-2">{t.thanks}!</h2>
            <p className="text-gray-600 mb-6">{t.yourScore} {score}/{triviaQuestions.length}</p>
            <button onClick={() => window.location.reload()} className="bg-blue-600 text-white px-8 py-3 rounded-xl font-bold">Restart Quiz</button>
        </div>
      </div>
    );
  }

  return null;
};

export default QuizApp;
